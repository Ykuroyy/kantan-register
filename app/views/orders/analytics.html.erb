<!-- app/views/orders/analytics.html.erb  ï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å…±é€šãƒ‡ã‚¶ã‚¤ãƒ³ç‰ˆï¼‰ -->

<div class="container">
     id="analytics-container"
     data-period-labels="<%= @period_labels.to_json %>"
     data-period-data="<%= @period_data.to_json %>"
     data-product-labels="<%= @product_sales.keys.to_json %>"
     data-product-data="<%= @product_sales.values.to_json %>">



  <%= link_to "ãƒˆãƒƒãƒ—ç”»é¢ã«æˆ»ã‚‹", root_path, class: "btn btn-gray" %>
  <h1 class="form-heading">ğŸ“ˆ å£²ä¸Šåˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>

  <!-- æœŸé–“ã‚¿ãƒ–ãƒ»ã‚°ãƒ©ãƒ•ãƒ»ã‚µãƒãƒªãƒ¼ã‚’ã‚«ãƒ¼ãƒ‰ã§ä¸¦ã¹ã‚‹ -->
  <div class="grid">
    <!-- â‘  æœŸé–“åˆ‡ã‚Šæ›¿ãˆã‚¿ãƒ– -->
    <div class="card">
      <div style="text-align:center; margin-bottom:1.2rem;">
        <% { "annual" => "å¹´é–“", "monthly" => "æœˆé–“", "daily" => "æ—¥åˆ¥" }.each do |key, label| %>
          <%= link_to label,
                      orders_analytics_path(period: key),
                      class: ["btn", (@period == key ? "btn-blue" : "btn-gray")].join(" "),
                      style: "margin:0 .25rem;" %>
        <% end %>
      </div>
    </div>

    <!-- â‘¡ æœŸé–“åˆ¥å£²ä¸Šã‚°ãƒ©ãƒ• -->
    <div class="card">
      <h2 class="chart-heading">
        <%= { "annual"=>"å¹´åº¦åˆ¥", "monthly"=>"æœˆåˆ¥", "daily"=>"æ—¥åˆ¥" }[@period] %>å£²ä¸Šã‚°ãƒ©ãƒ•
      </h2>
      <canvas id="period-sales-chart" width="600" height="300"></canvas>
    </div>

    <!-- â‘¢ å•†å“åˆ¥è²©å£²æ•°ã‚°ãƒ©ãƒ• -->
    <div class="card">
      <h2 class="chart-heading">ğŸ å•†å“åˆ¥è²©å£²æ•°ã‚°ãƒ©ãƒ•</h2>
      <canvas id="product-sales-chart" width="600" height="300"></canvas>
    </div>

    <!-- â‘£ å£²ä¸Šã‚µãƒãƒªãƒ¼ -->
    <div class="card">
      <h2 class="chart-heading">
        ğŸ“‹ å£²ä¸Šã‚µãƒãƒªãƒ¼ï¼ˆ<%= { "annual"=>"å¹´é–“", "monthly"=>"æœˆé–“", "daily"=>"æ—¥åˆ¥" }[@period] %>ï¼‰
      </h2>
      <ul class="sales-summary">
        <li>å£²ä¸Šé‡‘é¡ï¼š<%= number_to_currency(@total_sales) %></li>
        <li>æ³¨æ–‡æ•°ï¼š<%= @total_orders %> ä»¶</li>
        <li>è²©å£²ç·æ•°ï¼š<%= @total_items %> å€‹</li>
        <li>å¹³å‡è³¼å…¥é¡ï¼š<%= number_to_currency(@average_purchase) %></li>
      </ul>
    </div>
  </div>
</div>

<!-- Chart.js èª­ã¿è¾¼ã¿ -->
<%= javascript_include_tag "https://cdn.jsdelivr.net/npm/chart.js", defer: true %>
<%= javascript_include_tag "sales_analytics", defer: true %>

